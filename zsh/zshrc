source ~/.zprezto/init.zsh
host=`uname`

if [[ "$host" == "Darwin" ]]; then
    source ~/.zprezto/init.zsh
    source ~/.zprezto/runcoms/zshrc
    source ~/dotfiles/zprezto/.zpreztorc
    export PATH=/usr/local/bin:/opt/local/bin:/opt/local/sbin:$PATH
    export PATH=$HOME/dotfiles/bin:$PATH
    export TERM='xterm-256color'
    # MacOS: Bug that causes a lot of programs to show "Warning: Failed to set locale category .."
    # https://discourse.brew.sh/t/failed-to-set-locale-category-lc-numeric-to-en-ru/5092/6
    export LC_ALL=en_US.UTF-8

    alias bat="bat --theme=\$(defaults read -globalDomain AppleInterfaceStyle &> /dev/null && echo default || echo GitHub)"
else
    if [[ `export | grep TMUX` ]]; then
    else
        export TERM='xterm-256color'
    fi
    source ~/.zprezto/init.zsh
    source ~/.zprezto/runcoms/zshrc
    source ~/dotfiles/zprezto/.zpreztorc
fi

export EDITOR=nvim
export BROWSER=firefox
export PATH=$HOME/.gem/ruby/2.7.0/bin:$PATH
export PATH=$HOME/dotfiles/scripts:$HOME/dotfiles/bin/:$PATH
export PAGER=less

unset GREP_COLOR
unset GREP_OPTIONS

alias gst='git status'
alias gup='git pull --rebase'
alias clip='xsel -i -b'
alias ls='exa'
alias llsa='exa --all -l --grid --header --git'
alias lls='exa -l --grid --header --git'
#
# tmux aliases
alias tmls='tmux list-sessions'
alias tma='tmux attach-session'
alias tmn='tmux new-session'
alias tmks='tmux kill-server'

# task warrior aliases
alias t='task'

export GOPATH=~/go
export PATH=$PATH:$GOPATH/bin

if [[ "$host" == "Darwin" ]]; then
    export CLICOLOR=YES
    source ~/.zprezto/init.zsh
    source ~/.zprezto/runcoms/zshrc
    source ~/dotfiles/zprezto/.zpreztorc
else
    source ~/.zprezto/init.zsh
    source ~/.zprezto/runcoms/zshrc
    source ~/dotfiles/zprezto/.zpreztorc
fi

autoload -U edit-command-line
zle -N edit-command-line
bindkey '^xe' edit-command-line
bindkey '^x^e' edit-command-line

#source $HOME/dotfiles/zsh/fzf-marks.plugin.zsh
source $HOME/dotfiles/zsh/my_fzf.sh
source $HOME/dotfiles/zsh/zsh-interactive-cd.plugin.zsh

stty -ixon

fpath=($fpath $HOME/dotfiles/zsh/completion)
autoload -Uz compinit && compinit

[ -f /usr/share/fzf/key-bindings.zsh ] && source /usr/share/fzf/key-bindings.zsh
# For OSX
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh

[ -f ~/dotfiles/zsh/forgit.plugin.zsh ] && source ~/dotfiles/zsh/forgit.plugin.zsh

if [[ "$host" == "Darwin" ]]; then
    if [[ ! ( $(darkMode) =~ 'Dark' ) ]]; then
      kitty @ --to unix:/tmp/kitty set-colors --all --configured ~/.config/kitty/kitty-themes/themes/AtomOneLight.conf
    else
      kitty @ --to unix:/tmp/kitty set-colors --reset
    fi
fi

bindkey "^[[1;3C" forward-word
bindkey "^[[1;3D" backward-word

# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f $HOME/dotfiles/zsh/p10k.zsh ]] || source $HOME/dotfiles/zsh/p10k.zsh

# rust env
if [ -f $HOME/.cargo/env ]; then
    source $HOME/.cargo/env
fi
